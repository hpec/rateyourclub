- extends "base.html"
- load review_form_handler

- block content
        .row
            .card{'style': 'margin-left: 20px; padding-bottom: 5px;'}
                %h6
                    Displaying
                    ={clubs.start_index} - ={clubs.end_index} of ={clubs.paginator.count} result{{clubs.paginator.count|pluralize}}


        .row
            .pull-right.span3.card
                %div{'class':'span3'}
                    %h4 Categories
                    -# Placeholder for actiual comments
                    %ul{'class':'pull-left'}
                        :python
                            import random
                            for category in 'Academic Arts Cultural Other Political Profession Religious Service Sport'.split():
                                print '<li><a href="#">%s (%d)</a></li>' % (category, random.randint(1,1000))


            .span8.card
                %h3
                    %a{'href': "#"} Write Review
                - review_form_handler

            .span8.card
                .pull-right
                    Sort by
                    - if order == 'name'
                        %a{'href':'?order=pop'} Popularity
                        %strong
                            %a{'href':'?order=name'} Name
                    - else
                        %strong
                            %a{'href':'?order=pop'} Popularity
                        %a{'href':'?order=name'} Name

            - for club in clubs
                .span8.card
                    %ul.unstyled.pull-right
                      - if club.website
                              %li
                                  %a{ 'href' : "{{club.website}}" }
                                      %i.icon-external-link
                      - if club.facebook_url 
                          %li
                              %a{ 'href' : "{{club.facebook_url}}" }
                                  %i.icon-facebook-sign
                                  .hide-text
                                    {{ club.facebook_url}}



                    %h4
                        %a{'href' : "{% url 'club_info_view' club.id %}"}
                            {{club}}
                    %p
                        %span.intro-text
                            {{club.introduction|slice:":200"}}
                        - if club.introduction and club.introduction|length  > 200
                            %span.ellipsis
                                \...

                            %br
                            %a.show-more{ 'href' : "#" }
                              Read more
                            %span.hide-text
                              {{club.introduction}}
                    



        .row
            .span7
                - if clubs.paginator.count > 0
                    %div{'class':'pagination pagination-centered'}
                        %ul{'class' : 'step-links'}
                            %li{'class' : "{{ clubs.has_previous|yesno:',disabled' }}"}
                                - if clubs.has_previous
                                    %a{'href' : '?page={{clubs.previous_page_number}}&q={{request.GET.dict.q}}'} &larr;
                                - else
                                    %a{'href' : '#'} &larr;

                            - for i in clubs.paginator.page_range
                                - with offset_start=clubs.number|add:"-5"
                                    - if i < clubs.number and i > offset_start or i == 1 and i != clubs.number
                                        %li
                                            %a{'href':'?page={{i}}&q={{request.GET.dict.q}}'}
                                                {{i}}
                            %li{'class':'current active'}
                                %span
                                    {{clubs.number}}
                            - for i in clubs.paginator.page_range
                                - with offset_end=clubs.number|add:"5"
                                    - if i > clubs.number and i < offset_end or i == clubs.paginator.num_pages and i != clubs.number
                                        %li
                                            %a{'href':'?page={{i}}&q={{request.GET.dict.q}}'}
                                                {{i}}

                            %li{'class' : "{{ clubs.has_next|yesno:',disabled' }}"}
                                - if clubs.has_next
                                    %a{'href': '?page={{clubs.next_page_number}}&q={{request.GET.dict.q}}'}
                                        &rarr;
                                - else
                                    %a{'href': '#'}
                                        &rarr;
                        %p
                            page ={clubs.number} of ={clubs.paginator.num_pages}
        <script type="text/javascript">
        (function($){
            $(document).ready(function(){
              $(".show-more").click(function(e){
                $this = $(e.target);
                e.preventDefault();
                var toInsert = $this.siblings('.hide-text').text().trim();
                $this.siblings('.ellipsis').remove();
                var $target = $this.siblings('.intro-text');
                $target.text( toInsert);
                $this.remove();
              })
              });
          })(jQuery)
        </script>


